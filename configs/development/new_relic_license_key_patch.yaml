# This patch injects a secret into the container environment for the controller manager
# to enable New Relic agent to send events about the operator behavior itself.
apiVersion: v1
kind: Secret
metadata:
  name: nr-license-key
  namespace: system
  creationTimestamp: 2020-06-22T20:23:38Z
type: Opaque
stringData:
  license-key: <your New Relic license key, base64 encoded>
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: controller-manager
  namespace: system
spec:
  selector:
    matchLabels:
      control-plane: controller-manager
  template:
    spec:
      containers:
      - name: manager
        env:
          - name: NEW_RELIC_LICENSE_KEY
            valueFrom:
              secretKeyRef:
                name: nr-license-key
                key: license-key
